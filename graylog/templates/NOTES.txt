Welcome to Graylog!

SUMMARY

· Your helm release is named: {{ .Release.Name | quote }}.

· You are running Graylog version {{ include "graylog.tag" . | quote | trimAll "\"" }}

· The following workloads have been deployed to the cluster:

  - {{ include "graylog.replicas" . | int }} replicas of the Graylog application.
  - {{ include "graylog.datanode.replicas" . | int }} replicas of the Graylog Datanode.
  {{- if .Values.mongodb.subchart.enabled }}
  - {{ if eq .Values.mongodb.architecture "replicaset" }}{{ .Values.mongodb.replicaCount }} replicas{{ if .Values.mongodb.arbiter.enabled }} (+ 1 arbiter){{ end }} for MongoDB, running as a replicaset in Primary-Secondary{{if .Values.mongodb.arbiter.enabled }}-Arbiter{{ end }} mode.
    {{- else }}1 replica for MongoDB running in standalone mode.
    WARNING: running mongoDB in standalone mode is NOT SUPPORTED.{{ end }}
  {{- end }}

  Use the following command to list all the resources deployed with this release:

    helm get all {{ .Release.Name }} -n {{ .Release.Namespace }}

EXTERNAL ACCESS

· Your credentials are
  {{- if empty .Values.global.existingSecretName }}:

  - username: {{ .Values.graylog.config.rootUsername | quote }}
  - password: {{ include "graylog.rootPassword" .  | quote }}
  {{- else -}}
    {{ .Values.global.existingSecretName | quote | print " managed externally using the existing secret " }}.
  {{- end }}

{{- if eq .Values.graylog.service.type "LoadBalancer" }}

· Get the URL of the UI for your Graylog instance by running the following command:

    echo {{ .Values.graylog.config.tls.enabled | ternary "https" "http" }}://$(kubectl get svc --namespace {{ .Release.Namespace }} {{ include "graylog.service.name" . }} --template "{{"{{ with (index .status.loadBalancer.ingress 0) }}{{ or .hostname .ip }}{{ end }}"}}"):{{ .Values.graylog.service.ports.app | default 9000 | int }}/

{{- if .Release.IsInstall }}

  You might need to wait for a few minutes until:
  1. The corresponding LB is provisioned before retrieving the URL (~2 min).
  2. All workloads are ready before opening the URL in your browser (~5 min).
{{- end }}
{{- else if and .Values.ingress.enabled .Values.ingress.web.enabled }}
{{- if empty .Values.ingress.web.hosts }}
· Your instance is exposed through Ingress but no rules have been configured for the Ingress resource. You can add a rule using the following command:

    helm upgrade {{ .Release.Name }} ./graylog --namespace {{ .Release.Namespace }} --reuse-values --set "ingress.web.hosts[0].paths[0].path=/"
{{- else }}
{{ $firstHost := index .Values.ingress.web.hosts 0 }}
{{ $firstHostPath := include "graylog.ingress.defaultPath" . }}
{{- with $firstHost.paths }}
    {{ $firstHostPath = (index . 0).path | default $firstHostPath }}
{{- end }}
{{- if empty $firstHost.host | not }}
· Your instance is exposed through Ingress and can be accessed using the following URL:

    {{ empty .Values.ingress.web.tls | ternary "http" "https" }}://{{ $firstHost.host }}{{ $firstHostPath }}
{{- else }}
· Your instance is exposed through Ingress but no hostnames have been configured for the Ingress resource. A new host can be configured using the following command:

    helm upgrade {{ .Release.Name }} ./graylog --namespace {{ .Release.Namespace }} --reuse-values --set "ingress.web.hosts[0].host=<your-host>"

  Meanwhile, the Graylog UI can still be accessed using the address provided by your cluster’s ingress controller:

    {{ empty .Values.ingress.web.tls | ternary "http" "https" }}://<your-ingress-controller-address>{{ $firstHostPath }}

  The exact address depends on your cluster setup. If you are unsure, please check with your cluster administrator or cloud provider.

  Cluster administrators: you can find the external address of your ingress controller as follows (look for the EXTERNAL-IP or HOSTNAME field of the service associated with your ingress controller):

    kubectl get svc -n <ingress-namespace>

{{- end }}
{{- end }}
{{- if .Release.IsInstall }}

  You might need to wait for a few minutes until:
  1. The corresponding LB is provisioned for the Ingress Controller Service before retrieving your URL (~2 min).
  2. All workloads are ready before opening the URL in your browser (~5 min).
{{- end }}
{{- end }}
{{- with .Values.graylog.inputs }}

· The following INPUTS are set with their corresponding service:
{{ range . }}
    - name: {{ .name }}
      port: {{ .port | int }}
      protocol: {{ .protocol }}
{{ end }}
  Make sure to complete their configuration through the Graylog UI.
{{- end }}

ADDITIONAL NOTES
{{- if .Values.global.existingSecretName }}

· IMPORTANT: You are using {{ .Values.global.existingSecretName | quote }} as the global secret override. As a result, all Graylog and MongoDB secrets are assumed to be managed externally and not by this Helm chart. Accordingly, any of the following configuration values will be ignored:

    - graylog.config.rootUsername
    - graylog.config.rootPassword
    - graylog.config.secretPepper
    - graylog.config.tls.keyPassword
{{- else if empty .Values.graylog.config.rootPassword }}

· IMPORTANT: You are currently using a randomly generated password: {{ include "graylog.rootPassword" . | quote }}, which will NOT persist across upgrades. Please run the following command to set a persistent password:

    echo "Enter your new password and press return:" && read -s pass && echo "Upgrading helm release {{ squote .Release.Name}}..." && helm upgrade {{ .Release.Name }} ./graylog --namespace {{ .Release.Namespace }} --reuse-values --set "graylog.config.rootPassword=$pass"; unset pass
{{- end }}

· Use the following command to print this status page again:

    helm status {{ .Release.Name }} -n {{ .Release.Namespace }}

This chart is currently in beta and should NOT be used in production. Please create an issue in the `graylog2/graylog-helm` repo if you notice any unexpected behavior. We appreciate your feedback.
