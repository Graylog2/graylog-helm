Welcome to Graylog!

· Your helm release is named: {{ .Release.Name | quote }}.

· You are running Graylog version {{ include "graylog.imageTag" . | quote | trimAll "\"" }}

· Your credentials are
  {{- if empty .Values.global.existingSecretName }}:

  - username: {{ .Values.graylog.config.rootUsername | quote }}
  - password: {{ include "graylog.rootPassword" .  | quote }}
  {{- else -}}
    {{ .Values.global.existingSecretName | quote | print " managed externally using the existing secret " }}.
  {{- end }}

· The following workloads have been deployed to the cluster:

  - {{ include "graylog.replicas" . | int }} replicas of the Graylog application.
  - {{ include "datanode.replicas" . | int }} replicas of the Graylog Datanode.
  {{- if .Values.mongodb.subchart.enabled }}
  - {{ if eq .Values.mongodb.architecture "replicaset" }}{{ .Values.mongodb.replicaCount }} replicas{{ if .Values.mongodb.arbiter.enabled }} (+ 1 arbiter){{ end }} for MongoDB, running as a replicaset in Primary-Secondary{{if .Values.mongodb.arbiter.enabled }}-Arbiter{{ end }} mode.
    {{- else }}1 replica for MongoDB running in standalone mode.
    WARNING: running mongoDB in standalone mode is NOT SUPPORTED.{{ end }}
  {{- end }}

  Use the following command to list all the resources deployed with this release:

    helm get all {{ .Release.Name }} -n {{ .Release.Namespace }}

{{- if eq .Values.graylog.custom.service.type "LoadBalancer" }}

· Get the URL of the UI for your Graylog instance by running the following command:

    echo {{ .Values.graylog.config.tls.enabled | ternary "https" "http" }}://$(kubectl get svc --namespace {{ .Release.Namespace }} {{ include "graylog.serviceName" . }} --template "{{"{{ with (index .status.loadBalancer.ingress 0) }}{{ or .hostname .ip }}{{ end }}"}}"):{{ .Values.graylog.custom.service.ports.app | default 9000 | int }}/

{{- if .Release.IsInstall }}

  You might need to wait for a bit until:
    1. The corresponding LB is provisioned before retrieving the URL (~2 min).
    2. All workloads are ready before opening the URL in your browser (~5 min).
{{- end }}
{{- end }}
{{- if len .Values.graylog.inputs | lt 0 | and .Values.graylog.custom.inputs.enabled }}

· The following INPUTS are set with their corresponding service:
{{ range .Values.graylog.inputs }}
    - name: {{ .name }}
      port: {{ .port | int }}
      protocol: {{ .protocol }}
{{ end }}
  Make sure to complete their configuration through the Graylog UI.
{{- end }}
{{- if .Values.global.existingSecretName }}

· IMPORTANT: You are using {{ .Values.global.existingSecretName | quote }} as the global secret override. As a result, all Graylog and MongoDB secrets are assumed to be managed externally and not by this Helm chart. Accordingly, any of the following configuration values will be ignored:

    - graylog.config.rootUsername
    - graylog.config.rootPassword
    - graylog.config.secretPepper
    - graylog.config.tls.keyPassword
{{- else if empty .Values.graylog.config.rootPassword }}

· IMPORTANT: You are currently using a randomly generated password: {{ include "graylog.rootPassword" . | quote }}, which will not persist across upgrades. Please run the following command to set a persistent password:

    echo "Enter your new password and press return:" && read -s pass && echo "Upgrading helm release {{ squote .Release.Name}}..." && helm upgrade {{ .Release.Name }} ./graylog --namespace {{ .Release.Namespace }} --reuse-values --set "graylog.config.rootPassword=$pass"; unset pass
{{- end }}

· Use the following command to print this status page again:

    helm status {{ .Release.Name }} -n {{ .Release.Namespace }}

This chart is currently in beta and should NOT be used in production. Please create an issue in the `graylog-helm` repo if you notice any unexpected behavior. We appreciate your feedback.
